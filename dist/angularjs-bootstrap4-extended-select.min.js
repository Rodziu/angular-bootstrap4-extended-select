angular.module("extendedSelect",["angularBS.helpers","angularBS.dropdown"]),function(){"use strict";function e(e){angular.forEach(["ngOptions","select"],function(t){e.decorator(t+"Directive",["$delegate",function(e){return angular.forEach(e,function(e){const t=e.compile||function(){};e.compile=function(n){if("EXTENDED-SELECT"!==n[0].tagName)return t.apply(this,arguments)||e.link}}),e}])})}e.$inject=["$provide"],angular.module("extendedSelect").config(e)}(),function(){"use strict";angular.module("extendedSelect").provider("extendedSelect",function(){this.options={placeholder:" ",placeholderMultiple:" ",typeToSearch:0,typeToSearchText:"Zacznij pisać, by wyświetlić dostępne opcje",addOptionLang:"Dodaj",searchByValue:!1},this.$get=function(){return this.options}})}(),function(){"use strict";angular.module("extendedSelect").directive("extendedSelectDropdown",function(){return{restrict:"A",link:function(e,t){t.on("click",function(e){e.stopPropagation()})}}})}(),function(){"use strict";angular.module("extendedSelect").directive("extendedSelectOptions",function(){return{restrict:"A",bindToController:{activeIndex:"<extendedSelectOptions"},controller:["$element","angularBS",function(e,t){const n=this;n.$onChanges=function(){const l=e[0].querySelector(`li:nth-child(${n.activeIndex+1})`);if(null===l)return;const c=l.offsetTop,i=e[0].scrollTop,s=t.offset(l).height+c,o=t.offset(e[0]).height;i-c>0?e[0].scrollTop=c:i-s<-1*o&&(e[0].scrollTop=s-o)}}]}})}(),function(){"use strict";angular.module("extendedSelect").directive("extendedSelectSearch",function(){return{restrict:"A",require:"^extendedSelect",link:function(e,t,n,l){l.searchElement=t,t.on("keydown",function(t){if(!l.optionsFiltered.length)return void(13===t.which&&(l.addOptionAction(),e.$apply()));const n=l.activeIndex;switch(t.which){case 40:do{if(l.activeIndex++,l.activeIndex>=l.optionsFiltered.length){l.activeIndex=n;break}}while(l.multiple&&l.isSelected(l.optionsFiltered[l.activeIndex]));break;case 38:do{if(l.activeIndex--,l.activeIndex<0){l.activeIndex=n;break}}while(l.multiple&&l.isSelected(l.optionsFiltered[l.activeIndex]));break;case 13:if(angular.isDefined(l.optionsFiltered[l.activeIndex]))return l.pickOption(l.optionsFiltered[l.activeIndex]),void e.$apply()}e.$digest()})}}})}(),function(){"use strict";function e(e,t,n,l,c,i){const s=this,o=e[0].querySelector("[ng-transclude]"),a="ngOptions"in t?c.parseNgOptions(t.ngOptions):null,r=function(e,t){const n=[];for(let l=0;l<s.options.length;l++)!s.isSelected(s.options[l])&&!angular.equals(s.options[l].value,e)||angular.equals(s.options[l].value,t)||n.push(s.options[l].value);angular.equals(s.ngModel,n)||(s.ngModel=n)};s.getModelValue=function(e){angular.isUndefined(e)&&(e=s.ngModel);for(let t=0;t<s.options.length;t++)if(angular.equals(s.options[t].value,e))return s.options[t].label;return!1};let d,u=null;s.searchFn=function(){if(s.activeIndex=s.options.length?0:-1,angular.isFunction(s.resolveOnSearch)&&angular.isDefined(s.search)&&s.search.length){const e=angular.isUndefined(d)?0:750;null!==u&&l.cancel(u),d=s.search,s.loading=!0,u=l(function(){u=null,s.resolveOnSearch({value:s.search}).then(function(){d=void 0,s.loading=!1}).catch(function(){})},e)}},s.pickOption=function(e){s.multiple?(angular.isUndefined(s.ngModel)&&(s.ngModel=[]),~s.ngModel.indexOf(e.value)||r(e.value),s.activeIndex=-1,s.search=""):(s.isOpen=!1,s.ngModel=e.value,s.activeIndex=s.options.indexOf(e)),s.ngModelCtrl.$setViewValue(s.ngModel)},s.isSelected=function(e){return!angular.isUndefined(s.ngModel)&&(s.multiple?!!~s.ngModel.indexOf(e.value):angular.equals(e.value,s.ngModel))},s.deselect=function(e){s.multiple?r(void 0,e):s.ngModel=void 0,s.activeIndex=-1,s.ngModelCtrl.$setViewValue(s.ngModel)},s.addOptionAction=function(){if(angular.isFunction(s.addOption)&&s.search.length){let e=!1;for(let t=0;t<s.options.length;t++)if(s.options[t].label===s.search){s.pickOption(s.options[t]),e=!0;break}e||(s.addOption({value:s.search}),s.addOptionCalled=!0)}},e.on("click",function(){const e=s.isOpen;if(s.ngModelCtrl.$setTouched(),s.isDisabled||s.isReadonly?s.isOpen=!1:s.isOpen=!!s.multiple||!s.isOpen,!e&&s.isOpen){s.search="",s.activeIndex=-1;for(let e=0;e<s.options.length&&(!s.isSelected(s.options[e])||(s.activeIndex=e,s.multiple));e++);}n.$digest(),!e&&s.isOpen&&s.searchElement[0].focus()}),t.$observe("placeholder",function(e){s.placeholder=e}),s.$onInit=function(){s.options=[],s.optionsFiltered=[],s.activeIndex=-1,s.search="",s.multiple="multiple"in t,!s.deselectable&&"deselectable"in t&&!t.deselectable.length&&(s.deselectable=!0),s.addOptionLang=i.addOptionLang,angular.isUndefined(s.typeToSearch)&&(s.typeToSearch=i.typeToSearch),s.typeToSearchText=i.typeToSearchText,angular.isUndefined(s.searchByValue)&&(s.searchByValue=i.searchByValue),angular.isUndefined(s.placeholder)&&(s.placeholder="multiple"in t?i.placeholderMultiple:i.placeholder),e.hasClass("custom-select-sm")&&(e.children().addClass("custom-select-sm"),e.removeClass("custom-select-sm")),s.multiple&&(s.ngModelCtrl.$isEmpty=function(e){return!e||0===e.length})},s.$doCheck=function(){const l=o.querySelectorAll("option"),c=[];let i;for(let e=0;e<l.length;e++){const t=angular.element(l[e]);c.push({value:t.val(),label:t.text().trim()})}if(null!==a){const e=a.valuesFn(n.$parent);for(let t=0;t<e.length;t++){const l=a.getLocals(t,e[t]);c.push({value:a.valueFn(n.$parent,l),label:a.displayFn(n.$parent,l)}),s.addOptionCalled&&c[c.length-1].label===s.search&&(i=c[c.length-1],s.addOptionCalled=!1)}}angular.equals(c,s.options)||(s.options=c,angular.isDefined(i)&&s.pickOption(i)),s.isSmall=e.hasClass("custom-select-sm"),s.isLarge=e.hasClass("custom-select-lg"),s.isDisabled="disabled"in t&&(!0===t.disabled||angular.isString(t.disabled)),s.isReadonly="readonly"in t&&(!0===t.readonly||angular.isString(t.readonly))}}e.$inject=["$element","$attrs","$scope","$timeout","extendedSelectOptions","extendedSelect"],angular.module("extendedSelect").component("extendedSelect",{require:{ngModelCtrl:"ngModel"},bindings:{ngModel:"=",addOption:"&?",resolveOnSearch:"&?",deselectable:"<?",typeToSearch:"<?",searchByValue:"<?"},transclude:!0,templateUrl:["$attrs",function(e){return"multiple"in e?"src/templates/extended-select-multiple.html":"src/templates/extended-select.html"}],controllerAs:"ctrl",controller:e})}(),function(){"use strict";angular.module("extendedSelect").filter("extendedSelectFilter",function(){return function(e,t,n,l){if(angular.isUndefined(t))return e;if(t.length<n)return[];const c=[];t=t.toLowerCase();for(let n=0;n<e.length;n++)(~e[n].label.toLowerCase().indexOf(t)||l&&~e[n].value.toLowerCase().indexOf(t))&&c.push(e[n]);return c}})}(),function(){"use strict";function e(e){return function(t,n){return n.length&&(t=t.replace(new RegExp("("+n+")","gi"),"<u>$1</u>")),e.trustAsHtml(t)}}e.$inject=["$sce"],angular.module("extendedSelect").filter("extendedSelectSearch",e)}(),function(){"use strict";t.$inject=["$parse"];const e=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([$\w][$\w]*)|(?:\(\s*([$\w][$\w]*)\s*,\s*([$\w][$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/;function t(t){return{parseNgOptions:function(n){const l=n.match(e);if(null==l)return null;const c=l[5]||l[7],i=l[6];return{valueFn:t(l[2]?l[1]:c),displayFn:t(l[2]||l[1]),valuesFn:t(l[8]),getLocals:function(e,t){const n={};return n[c]=t,i&&(n[i]=e),n}}}}}angular.module("extendedSelect").factory("extendedSelectOptions",t)}(),angular.module("extendedSelect").run(["$templateCache",function(e){e.put("src/templates/extended-select-multiple.html",'<div class="dropdown custom-select angular-extended-select" bs-dropdown="ctrl.isOpen" ng-class="{\'custom-select-sm\': ctrl.isSmall, \'custom-select-lg\': ctrl.isLarge}" ng-disabled="ctrl.isDisabled" ng-readonly="ctrl.isReadonly"><span class="caret"></span><ul class="extended-select-multiple"><li ng-show="!ctrl.ngModel.length && !ctrl.isOpen">{{ctrl.placeholder}}</li><li ng-repeat="m in ctrl.ngModel" class="ext-select-choice" ng-if="ctrl.getModelValue(m)"><span>{{::ctrl.getModelValue(m)}}</span> <button type="button" class="close" ng-click="$event.stopPropagation();ctrl.deselect(m)" ng-if="!ctrl.isDisabled && !ctrl.isReadonly">&times;</button></li><li ng-show="ctrl.isOpen"><input type="text" ng-model="ctrl.search" extended-select-search ng-change="ctrl.searchFn()" ng-disabled="attr.disabled"> <a ng-click="$event.stopPropagation();ctrl.addOptionAction()" class="label label-success" ng-show="ctrl.addOption && ctrl.search">{{::ctrl.addOptionLang}}</a></li></ul><div class="clearfix"></div><div class="dropdown-menu" extended-select-dropdown ng-hide="!ctrl.typeToSearch && !ctrl.options.length"><ul class="dropdown-menu" extended-select-options="ctrl.activeIndex"><li class="dropdown-item" ng-repeat="o in ctrl.optionsFiltered = (ctrl.options | extendedSelectFilter:ctrl.search:ctrl.typeToSearch:ctrl.searchByValue)" ng-click="ctrl.pickOption(o)" ng-class="{\'active\': $index == ctrl.activeIndex, \'selected\': ctrl.isSelected(o)}"><a ng-bind-html="o.label | extendedSelectSearch:ctrl.search"></a></li><li class="dropdown-item" ng-show="ctrl.typeToSearch && ctrl.search.length < ctrl.typeToSearch"><a>{{::ctrl.typeToSearchText}}</a></li></ul></div><div ng-transclude style="display:none"></div></div>'),e.put("src/templates/extended-select.html",'<div class="dropdown custom-select angular-extended-select" bs-dropdown="ctrl.isOpen" ng-class="{\'custom-select-sm\': ctrl.isSmall, \'custom-select-lg\': ctrl.isLarge}" ng-disabled="ctrl.isDisabled" ng-readonly="ctrl.isReadonly"><a class="deselect" ng-if="ctrl.deselectable && ctrl.getModelValue() && !ctrl.isDisabled && !ctrl.isReadonly" ng-click="ctrl.deselect()">&times;</a> {{ctrl.getModelValue() || ctrl.placeholder}}<div class="clearfix"></div><div class="dropdown-menu" extended-select-dropdown><div ng-class="{\'input-group input-group-sm\': ctrl.addOption}"><input type="text" class="form-control form-control-sm" ng-model="ctrl.search" ng-change="ctrl.searchFn()" extended-select-search> <span ng-show="ctrl.loading"><i class="fa fa-spinner fa-spin ext-select-loading"></i></span> <span class="input-group-append" ng-if="ctrl.addOption"><button type="button" class="btn btn-success" ng-click="$event.stopPropagation();ctrl.addOptionAction()">{{::ctrl.addOptionLang}}</button></span></div><ul class="dropdown-menu" extended-select-options="ctrl.activeIndex"><li class="dropdown-item" ng-repeat="o in ctrl.optionsFiltered = (ctrl.options | extendedSelectFilter:ctrl.search:ctrl.typeToSearch:ctrl.searchByValue)" ng-click="ctrl.pickOption(o)" ng-class="{\'active\': $index == ctrl.activeIndex}"><a ng-bind-html="o.label | extendedSelectSearch:ctrl.search"></a></li><li class="dropdown-item" ng-show="ctrl.typeToSearch && ctrl.search.length < ctrl.typeToSearch"><a>{{::ctrl.typeToSearchText}}</a></li></ul></div><div ng-transclude style="display:none"></div></div>')}]);
//# sourceMappingURL=angularjs-bootstrap4-extended-select.min.js.map
