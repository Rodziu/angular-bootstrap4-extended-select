angular.module("extendedSelect",["angularBS.helpers","angularBS.dropdown"]),function(){"use strict";function e(e){angular.forEach(["ngOptions","select"],function(t){e.decorator(t+"Directive",["$delegate",function(e){return angular.forEach(e,function(e){const t=e.compile||function(){};e.compile=function(n){if("EXTENDED-SELECT"!==n[0].tagName)return t.apply(this,arguments)||e.link}}),e}])})}e.$inject=["$provide"],angular.module("extendedSelect").config(e)}(),function(){"use strict";angular.module("extendedSelect").provider("extendedSelect",function(){this.options={placeholder:" ",placeholderMultiple:" ",typeToSearch:0,typeToSearchText:"Zacznij pisać, by wyświetlić dostępne opcje",addOptionLang:"Dodaj",loadMoreResultsLang:"Pobierz więcej wyników",searchByValue:!1},this.$get=function(){return this.options}})}(),function(){"use strict";angular.module("extendedSelect").directive("extendedSelectDropdown",function(){return{restrict:"A",link:function(e,t){t.on("click",function(e){e.stopPropagation()})}}})}(),function(){"use strict";angular.module("extendedSelect").directive("extendedSelectOptions",function(){return{restrict:"A",bindToController:{activeIndex:"<extendedSelectOptions"},controller:["$element","angularBS",function(e,t){const n=this;n.$onChanges=function(){const l=e[0].querySelector(`li:nth-child(${n.activeIndex+1})`);if(null===l)return;const c=l.offsetTop,s=e[0].scrollTop,a=t.offset(l).height+c,i=t.offset(e[0]).height;s-c>0?e[0].scrollTop=c:s-a<-1*i&&(e[0].scrollTop=a-i)}}]}})}(),function(){"use strict";angular.module("extendedSelect").directive("extendedSelectSearch",function(){return{restrict:"A",require:"^extendedSelect",link:function(e,t,n,l){l.searchElement=t,t.on("keydown",function(t){if(!l.optionsFiltered.length)return void(13===t.which&&(l.addOptionAction(),e.$apply()));const n=l.activeIndex;switch(t.which){case 40:do{if(l.activeIndex++,l.activeIndex>=l.optionsFiltered.length){l.activeIndex=n;break}}while(l.multiple&&l.isSelected(l.optionsFiltered[l.activeIndex]));break;case 38:do{if(l.activeIndex--,l.activeIndex<0){l.activeIndex=n;break}}while(l.multiple&&l.isSelected(l.optionsFiltered[l.activeIndex]));break;case 13:if(angular.isDefined(l.optionsFiltered[l.activeIndex]))return l.pickOption(l.optionsFiltered[l.activeIndex]),void e.$apply()}e.$digest()})}}})}(),function(){"use strict";function e(e,t,n,l,c,s){const a=this,i=e[0].querySelector("[ng-transclude]"),o="ngOptions"in t?c.parseNgOptions(t.ngOptions):null,r=function(e,t){const n=[];for(let l=0;l<a.options.length;l++)!a.isSelected(a.options[l])&&!angular.equals(a.options[l].value,e)||angular.equals(a.options[l].value,t)||n.push(a.options[l].value);angular.equals(a.ngModel,n)||(a.ngModel=n)};a.getModelValue=function(e){angular.isUndefined(e)&&(e=a.ngModel);for(let t=0;t<a.options.length;t++)if(angular.equals(a.options[t].value,e))return a.options[t].label;return!1};let d,u=null;a.searchFn=function(e){if(angular.isUndefined(e)&&(a.activeIndex=a.options.length?0:-1),a.hasNextPage=!1,angular.isFunction(a.resolveOnSearch)&&(a.page=e||1,angular.isDefined(a.search)&&a.search.length)){const e=angular.isUndefined(d)?0:750;null!==u&&l.cancel(u),d=a.search,a.loading=!0,u=l(function(){u=null,a.resolveOnSearch({value:a.search,page:a.page}).then(function(e){d=void 0,a.loading=!1,a.hasNextPage=e&&!!e.hasNextPage}).catch(angular.noop)},e)}},a.pickOption=function(e){a.multiple?(angular.isUndefined(a.ngModel)&&(a.ngModel=[]),~a.ngModel.indexOf(e.value)||r(e.value),a.activeIndex=-1,a.search=""):(a.isOpen=!1,a.ngModel=e.value,a.activeIndex=a.options.indexOf(e)),a.hasNextPage=!1,a.ngModelCtrl.$setViewValue(a.ngModel)},a.isSelected=function(e){return!angular.isUndefined(a.ngModel)&&(a.multiple?!!~a.ngModel.indexOf(e.value):angular.equals(e.value,a.ngModel))},a.deselect=function(e){a.multiple?r(void 0,e):a.ngModel=void 0,a.activeIndex=-1,a.ngModelCtrl.$setViewValue(a.ngModel)},a.addOptionAction=function(){if(angular.isFunction(a.addOption)&&a.search.length){let e=!1;for(let t=0;t<a.options.length;t++)if(a.options[t].label===a.search){a.pickOption(a.options[t]),e=!0;break}e||(a.addOption({value:a.search}),a.addOptionCalled=!0)}},e.on("click",function(){const e=a.isOpen;if(a.ngModelCtrl.$setTouched(),a.isDisabled||a.isReadonly?a.isOpen=!1:a.isOpen=!!a.multiple||!a.isOpen,!e&&a.isOpen){a.search="",a.activeIndex=-1;for(let e=0;e<a.options.length&&(!a.isSelected(a.options[e])||(a.activeIndex=e,a.multiple));e++);}n.$digest(),!e&&a.isOpen&&a.searchElement[0].focus()}),t.$observe("placeholder",function(e){a.placeholder=e}),t.$observe("disabled",function(e){a.isDisabled=!0===e||angular.isString(e)}),t.$observe("readonly",function(e){a.isReadonly=!0===e||angular.isString(e)}),a.$onInit=function(){a.options=[],a.optionsFiltered=[],a.activeIndex=-1,a.search="",a.multiple="multiple"in t,!a.deselectable&&"deselectable"in t&&!t.deselectable.length&&(a.deselectable=!0),a.addOptionLang=s.addOptionLang,a.loadMoreResultsLang=s.loadMoreResultsLang,angular.isUndefined(a.typeToSearch)&&(a.typeToSearch=s.typeToSearch),a.typeToSearchText=s.typeToSearchText,angular.isUndefined(a.searchByValue)&&(a.searchByValue=s.searchByValue),angular.isUndefined(a.placeholder)&&(a.placeholder="multiple"in t?s.placeholderMultiple:s.placeholder),e.hasClass("custom-select-sm")&&(e.children().addClass("custom-select-sm"),e.removeClass("custom-select-sm")),a.multiple&&(a.ngModelCtrl.$isEmpty=function(e){return!e||0===e.length})},a.$doCheck=function(){const t=i.querySelectorAll("option"),l=[];let c;for(let e=0;e<t.length;e++){const n=angular.element(t[e]);l.push({value:n.val(),label:n.text().trim()})}if(null!==o){const e=o.valuesFn(n.$parent);for(let t=0;t<e.length;t++){const s=o.getLocals(t,e[t]);l.push({value:o.valueFn(n.$parent,s),label:o.displayFn(n.$parent,s)}),a.addOptionCalled&&l[l.length-1].label===a.search&&(c=l[l.length-1],a.addOptionCalled=!1)}}angular.equals(l,a.options)||(a.options=l,angular.isDefined(c)&&a.pickOption(c)),a.isSmall=e.hasClass("custom-select-sm"),a.isLarge=e.hasClass("custom-select-lg")}}e.$inject=["$element","$attrs","$scope","$timeout","extendedSelectOptions","extendedSelect"],angular.module("extendedSelect").component("extendedSelect",{require:{ngModelCtrl:"ngModel"},bindings:{ngModel:"=",addOption:"&?",resolveOnSearch:"&?",deselectable:"<?",typeToSearch:"<?",searchByValue:"<?"},transclude:!0,templateUrl:["$attrs",function(e){return"multiple"in e?"src/templates/extended-select-multiple.html":"src/templates/extended-select.html"}],controllerAs:"ctrl",controller:e})}(),function(){"use strict";angular.module("extendedSelect").filter("extendedSelectFilter",function(){return function(e,t,n,l){if(angular.isUndefined(t))return e;if(t.length<n)return[];const c=[];t=t.toLowerCase();for(let n=0;n<e.length;n++)(~e[n].label.toLowerCase().indexOf(t)||l&&~e[n].value.toLowerCase().indexOf(t))&&c.push(e[n]);return c}})}(),function(){"use strict";function e(e){return function(t,n){return n.length&&(t=t.replace(new RegExp("("+n+")","gi"),"<u>$1</u>")),e.trustAsHtml(t)}}e.$inject=["$sce"],angular.module("extendedSelect").filter("extendedSelectSearch",e)}(),function(){"use strict";t.$inject=["$parse"];const e=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([$\w][$\w]*)|(?:\(\s*([$\w][$\w]*)\s*,\s*([$\w][$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/;function t(t){return{parseNgOptions:function(n){const l=n.match(e);if(null==l)return null;const c=l[5]||l[7],s=l[6];return{valueFn:t(l[2]?l[1]:c),displayFn:t(l[2]||l[1]),valuesFn:t(l[8]),getLocals:function(e,t){const n={};return n[c]=t,s&&(n[s]=e),n}}}}}angular.module("extendedSelect").factory("extendedSelectOptions",t)}(),angular.module("extendedSelect").run(["$templateCache",function(e){e.put("src/templates/extended-select-multiple.html",'<div class="dropdown custom-select angular-extended-select" bs-dropdown="ctrl.isOpen" ng-class="{\'custom-select-sm\': ctrl.isSmall, \'custom-select-lg\': ctrl.isLarge}" ng-disabled="ctrl.isDisabled" ng-readonly="ctrl.isReadonly"><span class="caret"></span><ul class="extended-select-multiple"><li ng-show="!ctrl.ngModel.length && !ctrl.isOpen">{{ctrl.placeholder}}</li><li ng-repeat="m in ctrl.ngModel" class="ext-select-choice" ng-if="ctrl.getModelValue(m)"><span>{{::ctrl.getModelValue(m)}}</span> <button type="button" class="close" ng-click="$event.stopPropagation();ctrl.deselect(m)" ng-if="!ctrl.isDisabled && !ctrl.isReadonly">&times;</button></li><li ng-show="ctrl.isOpen"><input type="text" ng-model="ctrl.search" extended-select-search ng-change="ctrl.searchFn()" ng-disabled="attr.disabled"> <a ng-click="$event.stopPropagation();ctrl.addOptionAction()" class="label label-success" ng-show="ctrl.addOption && ctrl.search">{{::ctrl.addOptionLang}}</a></li></ul><div class="clearfix"></div><div class="dropdown-menu" extended-select-dropdown ng-hide="!ctrl.typeToSearch && !ctrl.options.length"><ul class="dropdown-menu" extended-select-options="ctrl.activeIndex"><li class="dropdown-item" ng-repeat="o in ctrl.optionsFiltered = (ctrl.options | extendedSelectFilter:ctrl.search:ctrl.typeToSearch:ctrl.searchByValue)" ng-click="ctrl.pickOption(o)" ng-class="{\'active\': $index == ctrl.activeIndex, \'selected\': ctrl.isSelected(o)}"><a ng-bind-html="o.label | extendedSelectSearch:ctrl.search"></a></li><li class="dropdown-item" ng-show="ctrl.typeToSearch && ctrl.search.length < ctrl.typeToSearch"><a>{{::ctrl.typeToSearchText}}</a></li><li class="dropdown-item" ng-show="ctrl.resolveOnSearch && ctrl.hasNextPage"><a class="text-primary" ng-click="ctrl.searchFn(ctrl.page + 1)">{{::ctrl.loadMoreResultsLang}}</a></li></ul></div><div ng-transclude style="display:none"></div></div>'),e.put("src/templates/extended-select.html",'<div class="dropdown custom-select angular-extended-select" bs-dropdown="ctrl.isOpen" ng-class="{\'custom-select-sm\': ctrl.isSmall, \'custom-select-lg\': ctrl.isLarge}" ng-disabled="ctrl.isDisabled" ng-readonly="ctrl.isReadonly"><a class="deselect" ng-if="ctrl.deselectable && ctrl.getModelValue() && !ctrl.isDisabled && !ctrl.isReadonly" ng-click="ctrl.deselect()">&times;</a> {{ctrl.getModelValue() || ctrl.placeholder}}<div class="clearfix"></div><div class="dropdown-menu" extended-select-dropdown><div ng-class="{\'input-group input-group-sm\': ctrl.addOption}"><input type="text" class="form-control form-control-sm" ng-model="ctrl.search" ng-change="ctrl.searchFn()" extended-select-search> <span ng-show="ctrl.loading"><i class="fa fa-spinner fa-spin ext-select-loading"></i></span> <span class="input-group-append" ng-if="ctrl.addOption"><button type="button" class="btn btn-success" ng-click="$event.stopPropagation();ctrl.addOptionAction()">{{::ctrl.addOptionLang}}</button></span></div><ul class="dropdown-menu" extended-select-options="ctrl.activeIndex"><li class="dropdown-item" ng-repeat="o in ctrl.optionsFiltered = (ctrl.options | extendedSelectFilter:ctrl.search:ctrl.typeToSearch:ctrl.searchByValue)" ng-click="ctrl.pickOption(o)" ng-class="{\'active\': $index == ctrl.activeIndex}"><a ng-bind-html="o.label | extendedSelectSearch:ctrl.search"></a></li><li class="dropdown-item" ng-show="ctrl.typeToSearch && ctrl.search.length < ctrl.typeToSearch"><a>{{::ctrl.typeToSearchText}}</a></li><li class="dropdown-item" ng-show="ctrl.resolveOnSearch && ctrl.hasNextPage"><a href="javascript:" class="text-primary" ng-click="ctrl.searchFn(ctrl.page + 1)">{{::ctrl.loadMoreResultsLang}}</a></li></ul></div><div ng-transclude style="display:none"></div></div>')}]);
//# sourceMappingURL=angularjs-bootstrap4-extended-select.min.js.map
