angular.module("extendedSelect",["angularBS.helpers","angularBS.dropdown"]),function(){"use strict";function e(e){angular.forEach(["ngOptions","select"],function(t){e.decorator(t+"Directive",["$delegate",function(e){return angular.forEach(e,function(e){const t=e.compile||function(){};e.compile=function(n){if("EXTENDED-SELECT"!==n[0].tagName)return t.apply(this,arguments)||e.link}}),e}])})}e.$inject=["$provide"],angular.module("extendedSelect").config(e)}(),function(){"use strict";angular.module("extendedSelect").provider("extendedSelect",function(){this.options={placeholder:" ",placeholderMultiple:" ",typeToSearch:0,typeToSearchText:"Zacznij pisać, by wyświetlić dostępne opcje",addOptionLang:"Dodaj",searchByValue:!1},this.$get=function(){return this.options}})}(),function(){"use strict";angular.module("extendedSelect").directive("extendedSelectDropdown",function(){return{restrict:"A",link:function(e,t){t.on("click",function(e){e.stopPropagation()})}}})}(),function(){"use strict";angular.module("extendedSelect").directive("extendedSelectOptions",function(){return{restrict:"A",bindToController:{activeIndex:"<extendedSelectOptions"},controller:["$element","angularBS",function(e,t){const n=this;n.$onChanges=function(){const l=e[0].querySelector(`li:nth-child(${n.activeIndex+1})`);if(null===l)return;const c=l.offsetTop,s=e[0].scrollTop,i=t.offset(l).height+c,o=t.offset(e[0]).height;s-c>0?e[0].scrollTop=c:s-i<-1*o&&(e[0].scrollTop=i-o)}}]}})}(),function(){"use strict";angular.module("extendedSelect").directive("extendedSelectSearch",function(){return{restrict:"A",require:"^extendedSelect",link:function(e,t,n,l){l.searchElement=t,t.on("keydown",function(t){if(!l.optionsFiltered.length)return void(13===t.which&&(l.addOptionAction(),e.$apply()));const n=l.activeIndex;switch(t.which){case 40:do{if(l.activeIndex++,l.activeIndex>=l.optionsFiltered.length){l.activeIndex=n;break}}while(l.multiple&&l.isSelected(l.optionsFiltered[l.activeIndex]));break;case 38:do{if(l.activeIndex--,l.activeIndex<0){l.activeIndex=n;break}}while(l.multiple&&l.isSelected(l.optionsFiltered[l.activeIndex]));break;case 13:if(angular.isDefined(l.optionsFiltered[l.activeIndex]))return l.pickOption(l.optionsFiltered[l.activeIndex]),void e.$apply()}e.$digest()})}}})}(),function(){"use strict";function e(e,t,n,l,c,s){const i=this,o=e[0].querySelector("[ng-transclude]"),a="ngOptions"in t?c.parseNgOptions(t.ngOptions):null,r=function(e,t){const n=[];for(let l=0;l<i.options.length;l++)!i.isSelected(i.options[l])&&!angular.equals(i.options[l].value,e)||angular.equals(i.options[l].value,t)||n.push(i.options[l].value);angular.equals(i.ngModel,n)||(i.ngModel=n)};i.getModelValue=function(e){angular.isUndefined(e)&&(e=i.ngModel);for(let t=0;t<i.options.length;t++)if(angular.equals(i.options[t].value,e))return i.options[t].label;return!1};let d,u=null;i.searchFn=function(){if(i.activeIndex=i.options.length?0:-1,angular.isFunction(i.resolveOnSearch)&&!i.multiple&&angular.isDefined(i.search)&&i.search.length){const e=angular.isUndefined(d)?0:750;null!==u&&l.cancel(u),d=i.search,i.loading=!0,u=l(function(){u=null,i.resolveOnSearch({value:i.search}).then(function(){d=void 0,i.loading=!1}).catch(function(){})},e)}},i.pickOption=function(e){i.multiple?(angular.isUndefined(i.ngModel)&&(i.ngModel=[]),~i.ngModel.indexOf(e.value)||r(e.value),i.activeIndex=-1,i.search=""):(i.isOpen=!1,i.ngModel=e.value,i.activeIndex=i.options.indexOf(e)),i.ngModelCtrl.$setViewValue(i.ngModel)},i.isSelected=function(e){return!angular.isUndefined(i.ngModel)&&(i.multiple?!!~i.ngModel.indexOf(e.value):angular.equals(e.value,i.ngModel))},i.deselect=function(e){i.multiple?r(void 0,e):i.ngModel=void 0,i.activeIndex=-1},i.addOptionAction=function(){if(angular.isFunction(i.addOption)&&i.search.length){let e=!1;for(let t=0;t<i.options.length;t++)if(i.options[t].label===i.search){i.pickOption(i.options[t]),e=!0;break}e||(i.addOption({value:i.search}),i.addOptionCalled=!0)}},e.on("click",function(){const e=i.isOpen;if(i.ngModelCtrl.$setTouched(),t.disabled?i.isOpen=!1:i.isOpen=!!i.multiple||!i.isOpen,!e&&i.isOpen){i.search="",i.activeIndex=-1;for(let e=0;e<i.options.length&&(!i.isSelected(i.options[e])||(i.activeIndex=e,i.multiple));e++);}n.$digest(),!e&&i.isOpen&&i.searchElement[0].focus()}),t.$observe("disabled",function(e){i.isDisabled=e}),t.$observe("placeholder",function(e){i.placeholder=e}),i.$onInit=function(){i.options=[],i.optionsFiltered=[],i.activeIndex=-1,i.search="",i.multiple="multiple"in t,!i.deselectable&&"deselectable"in t&&!t.deselectable.length&&(i.deselectable=!0),i.addOptionLang=s.addOptionLang,angular.isUndefined(i.typeToSearch)&&(i.typeToSearch=s.typeToSearch),i.typeToSearchText=s.typeToSearchText,angular.isUndefined(i.searchByValue)&&(i.searchByValue=s.searchByValue),angular.isUndefined(i.placeholder)&&(i.placeholder="multiple"in t?s.placeholderMultiple:s.placeholder),e.hasClass("custom-select-sm")&&(e.children().addClass("custom-select-sm"),e.removeClass("custom-select-sm")),i.multiple&&(i.ngModelCtrl.$isEmpty=function(e){return!e||0===e.length})},i.$doCheck=function(){const t=o.querySelectorAll("option"),l=[];let c;for(let e=0;e<t.length;e++){const n=angular.element(t[e]);l.push({value:n.val(),label:n.text().trim()})}if(null!==a){const e=a.valuesFn(n.$parent);for(let t=0;t<e.length;t++){const s=a.getLocals(t,e[t]);l.push({value:a.valueFn(n.$parent,s),label:a.displayFn(n.$parent,s)}),i.addOptionCalled&&l[l.length-1].label===i.search&&(c=l[l.length-1],i.addOptionCalled=!1)}}angular.equals(l,i.options)||(i.options=l,angular.isDefined(c)&&i.pickOption(c)),i.isSmall=e.hasClass("custom-select-sm"),i.isLarge=e.hasClass("custom-select-lg")}}e.$inject=["$element","$attrs","$scope","$timeout","extendedSelectOptions","extendedSelect"],angular.module("extendedSelect").component("extendedSelect",{require:{ngModelCtrl:"ngModel"},bindings:{ngModel:"=",addOption:"&?",resolveOnSearch:"&?",deselectable:"<?",typeToSearch:"<?",searchByValue:"<?"},transclude:!0,templateUrl:["$attrs",function(e){return"multiple"in e?"src/templates/extended-select-multiple.html":"src/templates/extended-select.html"}],controllerAs:"ctrl",controller:e})}(),function(){"use strict";angular.module("extendedSelect").filter("extendedSelectFilter",function(){return function(e,t,n,l){if(angular.isUndefined(t))return e;if(t.length<n)return[];const c=[];t=t.toLowerCase();for(let n=0;n<e.length;n++)(~e[n].label.toLowerCase().indexOf(t)||l&&~e[n].value.toLowerCase().indexOf(t))&&c.push(e[n]);return c}})}(),function(){"use strict";function e(e){return function(t,n){return n.length&&(t=t.replace(new RegExp("("+n+")","gi"),"<u>$1</u>")),e.trustAsHtml(t)}}e.$inject=["$sce"],angular.module("extendedSelect").filter("extendedSelectSearch",e)}(),function(){"use strict";t.$inject=["$parse"];const e=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([$\w][$\w]*)|(?:\(\s*([$\w][$\w]*)\s*,\s*([$\w][$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/;function t(t){return{parseNgOptions:function(n){const l=n.match(e);if(null==l)return null;const c=l[5]||l[7],s=l[6];return{valueFn:t(l[2]?l[1]:c),displayFn:t(l[2]||l[1]),valuesFn:t(l[8]),getLocals:function(e,t){const n={};return n[c]=t,s&&(n[s]=e),n}}}}}angular.module("extendedSelect").factory("extendedSelectOptions",t)}(),angular.module("extendedSelect").run(["$templateCache",function(e){e.put("src/templates/extended-select-multiple.html",'<div class="dropdown custom-select angular-extended-select" bs-dropdown="ctrl.isOpen" ng-class="{\'custom-select-sm\': ctrl.isSmall, \'custom-select-lg\': ctrl.isLarge}" ng-disabled="ctrl.isDisabled"><span class="caret"></span><ul class="extended-select-multiple"><li ng-show="!ctrl.ngModel.length && !ctrl.isOpen">{{ctrl.placeholder}}</li><li ng-repeat="m in ctrl.ngModel" class="ext-select-choice" ng-if="ctrl.getModelValue(m)"><span>{{::ctrl.getModelValue(m)}}</span> <button type="button" class="close" ng-click="$event.stopPropagation();ctrl.deselect(m)" ng-if="!ctrl.isDisabled">&times;</button></li><li ng-show="ctrl.isOpen"><input type="text" ng-model="ctrl.search" extended-select-search ng-change="ctrl.searchFn()" ng-disabled="attr.disabled"> <a ng-click="$event.stopPropagation();ctrl.addOptionAction()" class="label label-success" ng-show="ctrl.addOption && ctrl.search">{{::ctrl.addOptionLang}}</a></li></ul><div class="clearfix"></div><div class="dropdown-menu" extended-select-dropdown><ul class="dropdown-menu" extended-select-options="ctrl.activeIndex"><li class="dropdown-item" ng-repeat="o in ctrl.optionsFiltered = (ctrl.options | extendedSelectFilter:ctrl.search:ctrl.typeToSearch:ctrl.searchByValue)" ng-click="ctrl.pickOption(o)" ng-class="{\'active\': $index == ctrl.activeIndex, \'selected\': ctrl.isSelected(o)}"><a ng-bind-html="o.label | extendedSelectSearch:ctrl.search"></a></li><li class="dropdown-item" ng-show="ctrl.typeToSearch && ctrl.search == \'\'"><a>{{::ctrl.typeToSearchText}}</a></li></ul></div><div ng-transclude style="display:none"></div></div>'),e.put("src/templates/extended-select.html",'<div class="dropdown custom-select angular-extended-select" bs-dropdown="ctrl.isOpen" ng-class="{\'custom-select-sm\': ctrl.isSmall, \'custom-select-lg\': ctrl.isLarge}" ng-disabled="ctrl.isDisabled"><span class="caret"></span> <a class="deselect" ng-if="ctrl.deselectable && ctrl.getModelValue() && !ctrl.isDisabled" ng-click="ctrl.deselect()">&times;</a> {{ctrl.getModelValue() || ctrl.placeholder}}<div class="clearfix"></div><div class="dropdown-menu" extended-select-dropdown><div ng-class="{\'input-group input-group-sm\': ctrl.addOption}"><input type="text" class="form-control form-control-sm" ng-model="ctrl.search" ng-change="ctrl.searchFn()" extended-select-search> <span ng-show="ctrl.loading"><i class="fa fa-spinner fa-spin ext-select-loading"></i></span> <span class="input-group-append" ng-if="ctrl.addOption"><button type="button" class="btn btn-success" ng-click="$event.stopPropagation();ctrl.addOptionAction()">{{::ctrl.addOptionLang}}</button></span></div><ul class="dropdown-menu" extended-select-options="ctrl.activeIndex"><li class="dropdown-item" ng-repeat="o in ctrl.optionsFiltered = (ctrl.options | extendedSelectFilter:ctrl.search:ctrl.typeToSearch:ctrl.searchByValue)" ng-click="ctrl.pickOption(o)" ng-class="{\'active\': $index == ctrl.activeIndex}"><a ng-bind-html="o.label | extendedSelectSearch:ctrl.search"></a></li><li class="dropdown-item" ng-show="ctrl.typeToSearch && ctrl.search == \'\'"><a>{{::ctrl.typeToSearchText}}</a></li></ul></div><div ng-transclude style="display:none"></div></div>')}]);
//# sourceMappingURL=angularjs-bootstrap4-extended-select.min.js.map
