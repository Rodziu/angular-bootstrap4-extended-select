<!--
  ~ AngularJS extended select component.
  ~ Copyright (c) 2016-2019 Rodziu <mateusz.rohde@gmail.com>
  ~ License: MIT
  -->
<div class="dropdown custom-select angular-extended-select" bs-dropdown="ctrl.isOpen"
	 ng-class="{'custom-select-sm': ctrl.isSmall, 'custom-select-lg': ctrl.isLarge}" ng-disabled="ctrl.isDisabled" ng-readonly="ctrl.isReadonly">
	<a class="deselect" ng-if="ctrl.deselectable && ctrl.getModelValue() && !ctrl.isDisabled && !ctrl.isReadonly"
	   ng-click="ctrl.deselect()">&times;</a>
	{{ctrl.getModelValue() || ctrl.placeholder}}
	<div class="clearfix"></div>
	<div class="dropdown-menu" extended-select-dropdown>
		<div ng-class="{'input-group input-group-sm': ctrl.addOption}">
			<input type="text" class="form-control form-control-sm" ng-model="ctrl.search" ng-change="ctrl.searchFn()"
				   extended-select-search/>
			<span ng-show="ctrl.loading"><i class="fa fa-spinner fa-spin ext-select-loading"></i></span>
			<span class="input-group-append" ng-if="ctrl.addOption">
				<button type="button" class="btn btn-success"
						ng-click="$event.stopPropagation();ctrl.addOptionAction()">
					{{::ctrl.addOptionLang}}
				</button>
			</span>
		</div>
		<ul class="dropdown-menu" extended-select-options="ctrl.activeIndex">
			<li class="dropdown-item" ng-repeat="o in ctrl.optionsFiltered =
				(ctrl.options | extendedSelectFilter:ctrl.search:ctrl.typeToSearch:ctrl.searchByValue)"
				ng-click="ctrl.pickOption(o)"
				ng-class="{'active': $index == ctrl.activeIndex}">
				<a ng-bind-html="o.label | extendedSelectSearch:ctrl.search"></a>
			</li>
			<li class="dropdown-item" ng-show="ctrl.typeToSearch && ctrl.search.length < ctrl.typeToSearch">
				<a>{{::ctrl.typeToSearchText}}</a>
			</li>
		</ul>
	</div>
	<div ng-transclude style="display:none"></div>
</div>
